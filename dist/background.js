let keepTabActiveMode=!1,activeTabId=null,tabSwitchTimer=null;function setActiveTab(){chrome.tabs.query({active:!0,currentWindow:!0},e=>{e&&0<e.length&&(e=e[0]).url.includes("meet.google.com")&&(activeTabId=e.id)})}chrome.runtime.onMessage.addListener(e=>{if("enterFullScreen"===e.action){let a=!1,i=void 0,o;chrome.tabs.query({active:!0,windowType:"normal",currentWindow:!0},e=>{if(o=e[0].id,e[0].url.includes("meet.google.com")){const t=e[0].windowId;chrome.tabs.update(o,{active:!0},()=>{chrome.windows.update(t,{state:"fullscreen"})})}chrome.tabs.query({},e=>{for(var t=0;t<e.length;t++)e[t].audible&&(a=!0,i=e[t].id,winId=e[t].windowId);1==a&&i!=o&&chrome.tabs.update(i,{active:!0},()=>{chrome.windows.update(winId,{state:"fullscreen"})})})})}if("enterFullScreenJoin"===e.action){let a;chrome.tabs.query({active:!0,windowType:"normal",currentWindow:!0},e=>{if(a=e[0].id,e[0].url.includes("meet.google.com")){const t=e[0].windowId;chrome.tabs.update(a,{active:!0},()=>{chrome.windows.update(t,{state:"fullscreen"})})}})}"keepTabActive"===e.action&&(keepTabActiveMode=!0,setActiveTab()),"disableFullScreen"===e.action&&chrome.tabs.query({active:!0,windowType:"normal",currentWindow:!0},e=>{let t=t=e[0].id;if(e[0].url.includes("meet.google.com")){const a=e[0].windowId;chrome.tabs.update(t,{active:!0},()=>{chrome.windows.update(a,{state:"normal"})})}})}),chrome.tabs.onUpdated.addListener((e,t,a)=>{keepTabActiveMode&&a.url.includes("meet.google.com")&&(activeTabId=e)}),chrome.tabs.onActivated.addListener(e=>{keepTabActiveMode&&activeTabId&&activeTabId!==e.tabId&&(tabSwitchTimer&&clearTimeout(tabSwitchTimer),tabSwitchTimer=setTimeout(()=>{chrome.tabs.update(activeTabId,{active:!0})},300))}),chrome.webNavigation.onHistoryStateUpdated.addListener(e=>{e.transitionQualifiers&&"forward_back"===e.transitionQualifiers[0]&&e.url.startsWith("https://outlook.live.com/mail")&&chrome.tabs.query({active:!0,currentWindow:!0},e=>{e[0]&&chrome.tabs.sendMessage(e[0].id,{action:"userNavigatedBackOrForward"},e=>{})})});